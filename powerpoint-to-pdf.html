<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PPTX to PDF Converter</title>
</head>
<body style="font-family:sans-serif; text-align:center; padding:20px;">

  <h2>PPTX to PDF Converter</h2>
  <input type="file" id="pptFile" accept=".pptx">
  <button onclick="convertToPDF()">Convert to PDF</button>

  <!-- jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <!-- JSZip -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

  <script>
    async function convertToPDF() {
      const fileInput = document.getElementById("pptFile");
      if (fileInput.files.length === 0) {
        alert("Please upload a PPTX file first!");
        return;
      }

      const pptFile = fileInput.files[0];
      const arrayBuffer = await pptFile.arrayBuffer();

      const zip = await JSZip.loadAsync(arrayBuffer);
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      let slideIndex = 0;

      // Look inside ppt/slides/
      const slideFiles = Object.keys(zip.files).filter(f => f.startsWith("ppt/slides/slide") && f.endsWith(".xml"));

      slideFiles.sort(); // Ensure slide order

      for (const slideFile of slideFiles) {
        const content = await zip.files[slideFile].async("string");

        // Extract text between <a:t>...</a:t>
        const matches = [...content.matchAll(/<a:t>(.*?)<\/a:t>/g)].map(m => m[1]);

        if (slideIndex > 0) doc.addPage();

        doc.setFontSize(16);
        doc.text(`Slide ${slideIndex + 1}`, 20, 20);

        let y = 40;
        matches.forEach(text => {
          doc.setFontSize(12);
          doc.text(text, 20, y);
          y += 10;
        });

        slideIndex++;
      }

      doc.save("converted_ppt.pdf");
    }
  </script>

</body>
</html>
